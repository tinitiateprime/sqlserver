![SQL Server Tinitiate Image](../../../sqlserver-sql/sqlserver.png)

# SQL Server Tutorial
&copy; TINITIATE.COM

##### [Back To Contents](./README.md)

# DQL - Common Table Expressions (CTEs) Assignments

## CTE
1. List each client with their total number of accounts.
2. Compute sum of deposits per account using a CTE.
3. Find portfolios with more than 2 assets.
4. List financial goals with percentage progress.
5. Identify high‐value transactions (> 10,000).
6. Join clients and portfolios to show owner names.
7. Clients older than 40 years.
8. Assets acquired in 2023.
9. Average transaction amount per account.
10. Portfolio asset values (quantity × acquisition_price).

## Using Multiple CTEs
1. Show client names and their total deposits.
2. Compare portfolio counts and goal counts per client.
3. List assets with average price and total quantity.
4. Clients’ first and last transaction dates.
5. Account balances vs. goal targets.
6. Recent activity: last 5 transactions and goals per client.
7. Client summary: portfolios, assets, and goals.
8. Compare average transaction and average deposit per account.
9. Portfolio value vs. asset count.
10. High‐risk clients: top 5 by withdrawal volume.

## Recursive CTEs
1. Generate numbers 1–12 (months).
2. Monthly goal snapshots for client 1 for 6 months.
3. Running balance per account.
4. Date series from earliest join to today.
5. Cumulative transactions by day.
6. Hierarchical goal dependency (fictional parent_goal_id).
7. Generate 5‐year projection points.
8. Client tenure in years recursively.
9. Split portfolio values into deciles.
10. Build a calendar of weekdays for next 7 days.

##### [Back To Contents](./README.md)
***
| &copy; TINITIATE.COM |
|----------------------|
