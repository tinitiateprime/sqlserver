![SQL Server Tinitiate Image](../../../sqlserver-sql/sqlserver.png)

# SQL Server Tutorial

&copy; TINITIATE.COM

# DQL - Common Table Expressions (CTEs) Assignments

## CTE
1. Total number of bills per customer
2. Total line items per bill
3. Average bill amount per customer
4. Highest single line_total per product
5. Customers with no bills
6. Products never sold
7. Bill summary (count & sum) for bills in Q1 2023
8. Distinct billing months
9. Join bill and items count via CTE
10. Customers’ spend & items via CTE

## Using Multiple CTEs
1. Compare customer spend vs. average
2. Bills & details summary together
3. Top 5 customers by spend and their bill count
4. Monthly sales and item count
5. Products sold vs. unsold
6. Customer last bill date & next due via CTEs
7. Bill detail enriched with product price
8. Customers and whether they are VIP (spend>2000)
9. Bill ranking by total_amount and detail count
10. Customer  —  product purchase matrix via CTEs

## Recursive CTEs
1. Generate numbers 1 through 10
2. Calendar dates between two extremes
3. First day of each month in 2023
4. Fibonacci sequence first 10 values
5. Cumulative monthly sales via recursion
6. Generate invoice sequence IDs
7. List next 5 due dates per bill
8. Years from oldest to current year
9. Build a running customer spend list
10. Recursive product price depreciation (10% per year for 5 years)

***
| &copy; TINITIATE.COM |
|----------------------|
