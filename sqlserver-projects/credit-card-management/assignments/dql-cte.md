![SQL Server Tinitiate Image](../../../sqlserver-sql/sqlserver.png)

# SQL Server Tutorial

&copy; TINITIATE.COM

# DQL - Common Table Expressions (CTEs) Assignments

## CTE
1. Total transactions per card
2. Total spent per client
3. Clients with at least one blocked card
4. Average transaction amount per merchant
5. Statements above average closing balance
6. Payment count per client
7. Clients and their most recent transaction date
8. Cards and their next statement due date
9. Top 5 merchants by transaction count
10. Clients and their first/last transaction dates

## Using Multiple CTEs
1. Net spend per client = total charges - total refunds
2. Clients joined in 2023 with their total spent
3. Card utilization: limit vs spend
4. Statement vs payment summary
5. Merchant stats: count & avg
6. Client age group and spend
7. Monthly counts of statements and payments
8. High-limit cards and their last txn
9. Clients with no transactions or no payments
10. Filtered transactions then group

## Recursive CTEs
1. Calendar table for 2023
2. Sequence of months in 2023
3. Statement months per card between issue and expiry
4. Days since each client joined (first 30 days)
5. Generate numbers 1â€“20
6. Cumulative transaction sum per card via recursion (first 5 txns)
7. Next 5 due dates per statement
8. Client age progression (first 5 years)
9. Generate weeks between two dates (first 10 weeks)
10. Sequence of payment_ids in order (first 10)

***
| &copy; TINITIATE.COM |
|----------------------|
