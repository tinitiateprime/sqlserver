![SQL Server Tinitiate Image](../../../sqlserver-sql/sqlserver.png)

# SQL Server Tutorial
&copy; TINITIATE.COM

##### [Back To Contents](./README.md)

# DQL - Common Table Expressions (CTEs) Assignments

## CTE
1. Use a CTE to list loans with principal > 20000.
2. Use a CTE to compute total payments per loan.
3. Use a CTE to find average payment per loan.
4. Use a CTE to list active loans with borrower names.
5. Use a CTE to compute loan duration in days.
6. Use a CTE to find borrowers with more than one loan.
7. Use a CTE to list loans started this year.
8. Use a CTE to find late payments (payment_date > loan end date).
9. Use a CTE to find high‐interest loans (>5%).
10. Use a CTE to list payments with principal ratio.

## Using Multiple CTEs
1. Loan summary and payment summary joined.
2. Loans in 2023 and payments in 2023.
3. Borrower loan counts and payment counts.
4. Monthly payment sums and interest sums.
5. Active vs closed loan counts.
6. CTE for borrowers and CTE for their oldest loan.
7. Upcoming due loans and last payment dates.
8. Combine loan and borrower info.
9. Loans paid off vs outstanding balance.
10. CTE chain: borrower loan count → filter → details.

## Recursive CTEs
1. Generate numbers 1 to 12.
2. Generate years from 2000 to current year.
3. Monthly payment dates for loan_id = 1.
4. Running remaining principal for loan_id = 1.
5. Date dimension from earliest start to latest payment.
6. Cumulative payments for loan_id = 2.
7. Sequence of months up to term_months for loan_id = 6.
8. Payment schedule for loan_id = 9 between first and last payments.
9. Generate sequence 1 to 10.
10. List borrower birth years using a recursive CTE.

##### [Back To Contents](./README.md)
***
| &copy; TINITIATE.COM |
|----------------------|
